# -ArKnightsGachaReport-
明日方舟抽卡数据统计、可视化与Excel文件导出（by三鲸）
### 运行环境
win10系统，[导出excel]功能需要安装有excel.exe才能正常执行
### 用法说明：
#### ⭐获取数据链接⭐
电脑端登录 [个人中心 - 明日方舟 | 鹰角网络 https://ak.hypergryph.com/user/login]

依次点击左上角菜单-自助查询-寻访记录，进入寻访记录页面后，鼠标右键单击查看源码或尝试使用F12快捷键查看源码

选择[NetWork]或[网络]子页面后，点击切换寻访记录到任意一页记录

复制产生的任意一个含 "gacha?page" 的链接，即为抽卡数据分析所需数据链接
#### 启动抽卡分析
点击下载的exe可执行单文件，稍等片刻后程序才能运行

（请勿反复单击exe文件，否则会启动多个本程序）
#### 传入数据链接
这里的用户名仅用于区分不同用户，无需与游戏真实用户名相关

点击[获取数据]后，程序将把输入的用户名和数据链接存入同目录下UserData文件夹中的cache.txt

下次启动程序将自动填充cache.txt中的用户名和数据链接
#### 获取数据
程序首先将检查同目录下UserData文件夹中是否存在[用户名+"明日方舟抽卡记录.xlsx"]的文件

若文件存在且有效，将把自数据链接中取得的抽卡数据更新写入这个文件

否则会创建一个这样的文件用于存储抽卡数据

数据获取完毕后将进行可视化渲染
#### 寻访分类
点击[寻访分类]，将弹出寻访分类子页面

[寻访标注]用于将指定范围数据的“寻访类别”修改为输入的寻访名称

[标注移除]用于将选择的寻访类别全部重置为“标准寻访”

按下[确定]后，都将重新进行可视化渲染并即时更新[寻访分类]页面中的数据表

#### 导出excel
点击[导出excel]后，将在片刻后对excel文件美化后导出到指定目录

需要手动点击保存更改，美化工作才能生效

完整执行了导出步骤的excel文件将用不同颜色对不同星级角色进行标注

此外激活了首行的筛选按键，用户可以自行筛选某一寻访类别或某一星级数据进行查看
